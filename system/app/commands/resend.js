let e={};export const setup={name:"resend",version:"40.0.3",permission:"GroupAdmin",creator:"John Lester",description:"Resend a unsend message",category:"General",usages:["on","off"],mainScreenshot:["/media/resend/screenshot/main.jpg"],screenshot:["/media/resend/screenshot/main.jpg"],cooldown:5};export const execEvent=async function({api:a,event:s,Users:t,umaru:n,kernel:d}){try{if(1==n.config.PerformanceMode&&0==n.config.PerformanceModeConfig.resend||"message_unsend"==s.type&&(s.senderID==a.getCurrentUserID()||s.senderID==s.threadID)||0==s.isGroup||n.data.threads[s.threadID]&&1!=n.data.threads[s.threadID].resend)return;let m={[s.senderID]:[]};const r=await t.getName(s.senderID);if("message_unsend"==s.type)if(e.data[s.messageID]&&0===e.data[s.messageID].attachments.length)a.sendMessage({body:`${r} removed 1 message\ncontent: ${e.data[s.messageID].message}`,mentions:[{tag:r,id:s.senderID}]},s.threadID);else{if(e.data[s.messageID]&&"share"==e.data[s.messageID].attachments[0].type&&a.sendMessage({body:`${r} removed 1 message\ncontent: ${e.data[s.messageID].message}`,mentions:[{tag:r,id:s.senderID}]},s.threadID),e.data[s.messageID]&&"photo"==e.data[s.messageID].attachments[0].type){let t;t=e.data[s.messageID]&&e.data[s.messageID].attachments.length>1?"photos":"photo";for(const a of e.data[s.messageID].attachments)m[s.senderID].push(await d.readStream(a.url,"jpg"));a.sendMessage({body:`${r} just removed ${e.data[s.messageID].attachments.length} ${t}\ncontent: ${e.data[s.messageID].message}`,attachment:m[s.senderID],mentions:[{tag:r,id:s.senderID}]},s.threadID)}if(e.data[s.messageID]&&"animated_image"==e.data[s.messageID].attachments[0].type){let t;t=e.data[s.messageID]&&e.data[s.messageID].attachments.length>1?"gif images":"gif image";for(const a of e.data[s.messageID].attachments)m[s.senderID].push(await d.readStream(a.url,"gif"));a.sendMessage({body:`${r} just removed ${e.data[s.messageID].attachments.length} ${t}\ncontent: ${e.data[s.messageID].message}`,attachment:m[s.senderID],mentions:[{tag:r,id:s.senderID}]},s.threadID)}if(e.data[s.messageID]&&"video"==e.data[s.messageID].attachments[0].type){for(const a of e.data[s.messageID].attachments)m[s.senderID].push(await d.readStream(a.url,"mp4"));a.sendMessage({body:`${r} just removed ${e.data[s.messageID].attachments.length} video\ncontent: ${e.data[s.messageID].message}`,attachment:m[s.senderID],mentions:[{tag:r,id:s.senderID}]},s.threadID)}if(e.data[s.messageID]&&"audio"==e.data[s.messageID].attachments[0].type){for(const a of e.data[s.messageID].attachments)m[s.senderID].push(await d.readStream(a.url,"mp3"));a.sendMessage({body:`${r} just removed ${e.data[s.messageID].attachments.length} audio\ncontent: ${e.data[s.messageID].message}`,attachment:m[s.senderID],mentions:[{tag:r,id:s.senderID}]},s.threadID)}e.data[s.messageID]&&"sticker"==e.data[s.messageID].attachments[0].type&&a.sendMessage({body:`${r} just removed ${e.data[s.messageID].attachments.length} sticker\ncontent: ${e.data[s.messageID].attachments[0].caption}`,mentions:[{tag:r,id:s.senderID}]},s.threadID,(async()=>{a.sendMessage({sticker:e.data[s.messageID].attachments[0].stickerID},s.threadID)}))}else s.attachments.length,e.data||(e.data={}),e.data[s.messageID]||(e.data[s.messageID]={}),e.data[s.messageID].message||(e.data[s.messageID].message=s.body),e.data[s.messageID].attachments||(e.data[s.messageID].attachments=s.attachments)}catch{}};export const execCommand=async function({api:e,event:a,umaru:s,prefix:t,usage:n,args:d,context:m,translate:r}){if(0==a.isGroup)return e.sendMessage(await r("⚠️ This command is only allowed in group chat.",a,null,!0),a.threadID,a.messageID);let g=!(!d[0]||"on"!==d[0].toLowerCase())||(!d[0]||"off"!==d[0].toLowerCase())&&null;if(0===d.length||null===g)return n(this,t,a);let o=await r(!0===g?"enabled":"disabled",a,null,!0);return s.data.threads[a.threadID].resend=g,await s.save(),e.sendMessage(m+await r("✅ Resend successfully",a,null,!0)+" "+o,a.threadID,a.messageID)};